

## Giải Pháp Blackjack - Phần 2: Tính Điểm và Xử Lý Ace

### Bước 3: Tạo Hàm calculate_score()

**Mục tiêu:** Tạo hàm nhận danh sách bài làm input và trả về tổng điểm sau khi tính toán.

```python
def calculate_score(cards):
    """Take a list of cards and return the score calculated from the cards"""
    return sum(cards)
```

**Giải thích hàm sum():**

- `sum()` là hàm built-in của Python
- Nhận vào một iterable (list, tuple, v.v.)
- Tự động cộng tất cả phần tử trong list
- Trả về tổng kết quả

**Ví dụ minh họa:**

```python
cards = [1, 5, 3, 4]
total = sum(cards)  # Kết quả: 1 + 5 + 3 + 4 = 13
```


### Bước 4: Xử Lý Blackjack (21 Điểm với 2 Lá)

**Điều kiện Blackjack:**

- Chỉ có đúng 2 lá bài
- Một lá Ace (11) và một lá có giá trị 10
- Tổng điểm = 21

**Cách 1 - Kiểm tra cụ thể:**

```python
if 11 in cards and 10 in cards and len(cards) == 2:
    return 0  # 0 đại diện cho Blackjack
```

**Cách 2 - Kiểm tra đơn giản hơn:**

```python
if sum(cards) == 21 and len(cards) == 2:
    return 0  # Tổng 21 với 2 lá chắc chắn là Blackjack
```

**Giải thích:**

- Trả về 0 để đánh dấu đây là Blackjack
- 10 + 11 = 21, không có cách nào khác để có 21 với chỉ 2 lá
- Cách 2 ngắn gọn và dễ hiểu hơn


### Bước 5: Xử Lý Ace Khi Vượt 21

**Quy tắc Ace:**

- Ban đầu Ace được tính là 11
- Nếu tổng điểm > 21 → chuyển Ace thành 1
- Giúp người chơi tránh bị Bust

**Điều kiện xử lý:**

```python
if 11 in cards and sum(cards) > 21:
    cards.remove(11)
    cards.append(1)
```

**Phương thức remove():**

- Tìm phần tử đầu tiên khớp với giá trị cho trước
- Xóa phần tử đó khỏi list
- Cú pháp: `list.remove(value)`

**Luồng xử lý:**

1. Kiểm tra có Ace (11) trong bài không
2. Kiểm tra tổng điểm có > 21 không
3. Nếu cả hai điều kiện đúng → xóa 11, thêm 1
4. Tổng điểm giảm 10 đơn vị, có thể tránh Bust

### Hàm calculate_score() Hoàn Chỉnh

```python
def calculate_score(cards):
    """Take a list of cards and return the score calculated from the cards"""
    
    # Kiểm tra Blackjack (21 với 2 lá)
    if sum(cards) == 21 and len(cards) == 2:
        return 0  # 0 đại diện cho Blackjack
    
    # Xử lý Ace khi vượt 21
    if 11 in cards and sum(cards) > 21:
        cards.remove(11)
        cards.append(1)
    
    return sum(cards)
```

**Thứ tự kiểm tra quan trọng:**

1. Kiểm tra Blackjack trước (2 lá, tổng 21)
2. Xử lý Ace nếu cần (vượt 21)
3. Cuối cùng mới tính và trả về tổng điểm

### So Sánh append() và remove()

**append() - Thêm phần tử:**

```python
cards = [5, 10]
cards.append(3)  # Kết quả: [5, 10, 3]
```

**remove() - Xóa phần tử:**

```python
cards = [11, 5, 10]
cards.remove(11)  # Kết quả: [5, 10]
```

**Lưu ý về remove():**

- Chỉ xóa lần xuất hiện đầu tiên
- Nếu không tìm thấy → gây lỗi ValueError
- Nên kiểm tra phần tử có tồn tại trước khi xóa


### Ví Dụ Minh Họa

**Trường hợp 1 - Blackjack:**

```python
cards = [11, 10]
score = calculate_score(cards)  # Trả về: 0 (Blackjack)
```

**Trường hợp 2 - Xử lý Ace:**

```python
cards = [11, 8, 7]  # Tổng = 26 (> 21)
score = calculate_score(cards)
# Sau xử lý: cards = [1, 8, 7], tổng = 16
```

**Trường hợp 3 - Không cần xử lý:**

```python
cards = [10, 5, 3]  # Tổng = 18 (< 21, không có Ace)
score = calculate_score(cards)  # Trả về: 18
```


### Mã Nguồn Tích Hợp

```python
import random

def deal_card():
    """Returns a random card from the deck."""
    cards = [11, 2, 3, 4, 5, 6, 7, 8, 9, 10, 10, 10, 10]
    return random.choice(cards)

def calculate_score(cards):
    """Take a list of cards and return the score calculated from the cards"""
    if sum(cards) == 21 and len(cards) == 2:
        return 0
    if 11 in cards and sum(cards) > 21:
        cards.remove(11)
        cards.append(1)
    return sum(cards)

# Khởi tạo và chia bài
user_cards = []
computer_cards = []

for _ in range(2):
    user_cards.append(deal_card())
    computer_cards.append(deal_card())

# Tính điểm
user_score = calculate_score(user_cards)
computer_score = calculate_score(computer_cards)
```


### Ghi Chú Thêm

**Tại sao trả về 0 cho Blackjack?**

- Dễ phân biệt với các điểm số thông thường (1-21)
- Có thể dùng điều kiện `if score == 0` để kiểm tra Blackjack
- Convention (quy ước) trong thiết kế game này

**Logic xử lý Ace:**

- Chỉ xử lý khi CẢ HAI điều kiện đúng
- Tránh xóa Ace khi chưa cần thiết
- Giữ Ace = 11 càng lâu càng tốt để tối đa hóa điểm

**Liên kết:** [[calculate_score]], [[sum()]], [[Blackjack]], [[Ace]], [[remove()]], [[append()]], [[List Operations]], [[Bust]], [[Score Calculation]], [[Conditional Logic]]

