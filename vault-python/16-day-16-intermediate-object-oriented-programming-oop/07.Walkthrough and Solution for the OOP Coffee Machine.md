
## Giải pháp OOP Coffee Machine - Walkthrough

### Lời khuyên trước khi bắt đầu

Nếu gặp khó khăn với project này:

- Review lại các bài học về OOP
- Nghe và thực hành lý thuyết nhiều lần
- Hiểu rõ concepts trước khi code


### Setup ban đầu

**Collapse project folder:**
Chỉ focus vào `main.py` - không cần quan tâm các files khác.

**4 Classes đã import:**

```python
from menu import Menu, MenuItem
from coffee_maker import CoffeeMaker  
from money_machine import MoneyMachine
```


### Bước 1: In báo cáo tài nguyên (Report)

**Phân tích documentation:**

- `CoffeeMaker` có method `report()` - in water, milk, coffee
- `MoneyMachine` có method `report()` - in profit hiện tại

**Tạo objects:**

```python
# Object từ MoneyMachine class
money_machine = MoneyMachine()

# Object từ CoffeeMaker class
coffee_maker = CoffeeMaker()
```

**Quy tắc đặt tên:**

- Class name: Pascal Case (ví dụ: `MoneyMachine`, `CoffeeMaker`)
- Object name: snake_case (ví dụ: `money_machine`, `coffee_maker`)
- Thường đặt tên object theo lowercase version của class

**Gọi report methods:**

```python
money_machine.report()  # In tiền
coffee_maker.report()   # In tài nguyên
```

**Kết quả khi chạy:**

- Hiển thị lượng tiền hiện tại
- Hiển thị tài nguyên: water, milk, coffee

**Nguyên tắc OOP:**
Không cần biết `report()` implement như thế nào bên trong. Chỉ cần:

1. Đọc documentation
2. Tìm method phù hợp
3. Tin tưởng nó hoạt động đúng

### Bước 2: Kiểm tra tài nguyên đủ không

**Setup main loop:**

```python
is_on = True

while is_on:
    # Coffee machine logic
```

**Tạo Menu object và lấy options:**

```python
# Tạo menu object
menu = Menu()

# Trong while loop:
options = menu.get_items()  # Trả về string: "latte/espresso/cappuccino/"
```

**Lấy user input:**

```python
choice = input(f"What would you like? ({options}): ")
```

**Xử lý commands đặc biệt:**

```python
if choice == "off":
    is_on = False
elif choice == "report":
    coffee_maker.report()
    money_machine.report()
```

**Tìm drink từ order name:**

```python
else:
    # Tìm menu item từ user choice
    drink = menu.find_drink(choice)
    print(drink)  # In ra: <menu.MenuItem object at 0x...>
```

**Method `find_drink()`:**

- Input: order_name (string)
- Output: MenuItem object (nếu tìm thấy) hoặc None (nếu không có)

**Kiểm tra tài nguyên:**

```python
# Thay print(drink) bằng:
if coffee_maker.is_resource_sufficient(drink):
    # Đủ tài nguyên - tiếp tục
```

**Method `is_resource_sufficient()`:**

- Input: MenuItem object (drink)
- Output: True (đủ nguyên liệu) hoặc False (thiếu nguyên liệu)
- Tự động in thông báo nếu thiếu


### Bước 3 \& 4: Xử lý thanh toán

**Method `make_payment()`:**

```python
if money_machine.make_payment(drink.cost):
    # Payment successful
```

**Cách hoạt động:**

- Input: cost (số tiền cần thanh toán)
- Tự động hỏi user insert coins (quarters, dimes, nickels, pennies)
- Tự động tính toán và trả lại tiền thừa
- Output: True (thanh toán thành công) hoặc False (không đủ tiền)

**Truy cập attribute `cost`:**

```python
drink.cost  # Lấy giá của menu item
```

**MenuItem attributes:**

- `drink.name` - Tên đồ uống
- `drink.cost` - Giá tiền
- `drink.ingredients` - Nguyên liệu cần

**Lưu ý quan trọng:**
Method `make_payment()` đã xử lý tất cả:

- Process coins (gọi method `process_coins()` bên trong)
- Tính toán payment
- Thêm tiền vào profit
- Trả lại tiền thừa
→ Không cần tự viết logic xử lý coins!


### Bước 5: Pha cà phê

**Method `make_coffee()`:**

```python
coffee_maker.make_coffee(drink)
```

**Input:** MenuItem object

**Chức năng:**

- Trừ tài nguyên tương ứng
- In thông báo "Here is your [drink name] ☕️. Enjoy!"


### Code hoàn chỉnh

```python
from menu import Menu, MenuItem
from coffee_maker import CoffeeMaker
from money_machine import MoneyMachine

# Tạo objects
money_machine = MoneyMachine()
coffee_maker = CoffeeMaker()
menu = Menu()

is_on = True

while is_on:
    options = menu.get_items()
    choice = input(f"What would you like? ({options}): ")
    
    if choice == "off":
        is_on = False
    elif choice == "report":
        coffee_maker.report()
        money_machine.report()
    else:
        drink = menu.find_drink(choice)
        if coffee_maker.is_resource_sufficient(drink) and money_machine.make_payment(drink.cost):
            coffee_maker.make_coffee(drink)
```

**Code đơn giản hóa hơn nữa:**

Kết hợp điều kiện kiểm tra tài nguyên và thanh toán trong cùng một if statement:

```python
if coffee_maker.is_resource_sufficient(drink) and money_machine.make_payment(drink.cost):
    coffee_maker.make_coffee(drink)
```

**Logic:** Chỉ pha cà phê khi:

1. Đủ tài nguyên (is_resource_sufficient = True)
2. Thanh toán thành công (make_payment = True)

### Test chương trình

**Scenario 1: Đặt hàng thành công**

```
What would you like? (latte/espresso/cappuccino/): report
Water: 300ml
Milk: 200ml
Coffee: 100g
Money: $0.0

What would you like? (latte/espresso/cappuccino/): latte
How many quarters?: 10
How many dimes?: 0
How many nickels?: 0  
How many pennies?: 0
Here is $0.0 in change.
Here is your latte ☕️. Enjoy!
```

**Scenario 2: Hết nguyên liệu**

```
What would you like? (latte/espresso/cappuccino/): latte
Sorry there is not enough water.
Sorry there is not enough milk.
```

**Scenario 3: Report sau vài đơn**

```
What would you like? (latte/espresso/cappuccino/): report
Water: 100ml    # Đã giảm
Milk: 50ml      # Đã giảm  
Coffee: 76g     # Đã giảm
Money: $5.0     # Đã tăng
```


### Ưu điểm của OOP approach

**Code ngắn gọn:**

- Chỉ ~20 dòng code chính
- So với procedural: 100+ dòng

**Dễ đọc và hiểu:**

- Tên methods rõ ràng (`make_coffee`, `make_payment`)
- Không cần biết implementation details
- Logic flow rõ ràng

**Dễ maintain:**

- Mỗi object tự quản lý data của mình
- Thay đổi một class không ảnh hưởng code khác
- Dễ debug và fix bugs

**Khả năng mở rộng:**
Muốn thêm tính năng mới (ví dụ: loyalty program)?
→ Chỉ cần thêm methods vào class tương ứng, không cần sửa main logic

### Object tự quản lý state

**CoffeeMaker object:**

- Tự theo dõi resources (water, milk, coffee)
- Tự trừ resources khi pha cà phê
- Tự kiểm tra đủ nguyên liệu không

**MoneyMachine object:**

- Tự theo dõi profit
- Tự xử lý coins
- Tự tính toán change

→ Không cần global variables để theo dõi state!

### Học gì từ bài này

**Cách làm việc với existing code:**

- Đọc documentation kỹ
- Hiểu input/output của methods
- Tin tưởng implementation
- Focus vào integration, không phải implementation

**Tư duy OOP:**

- Object = "nhân viên" với chuyên môn riêng
- Method = "nhiệm vụ" mà object biết cách làm
- Manager (main.py) = chỉ đạo, không làm chi tiết

**Bước tiếp theo:**
Trong các bài tiếp theo sẽ học:

- Cách tạo classes riêng của bạn
- Initialization (`__init__`)
- Keyword `self`
- Class declaration

***

**Liên kết:** [[OOP]], [[Coffee Machine]], [[Class]], [[Object]], [[Methods]], [[Attributes]], [[Documentation]], [[State Management]], [[CoffeeMaker]], [[MoneyMachine]], [[Menu]], [[MenuItem]], [[Code Organization]], [[Abstraction]], [[Encapsulation]], [[Object State]], [[Python OOP]]

