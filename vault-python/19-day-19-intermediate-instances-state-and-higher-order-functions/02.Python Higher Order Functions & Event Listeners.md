

## Event Listeners \& Higher Order Functions

### Khái Niệm Event Listeners

**Event Listeners (Trình lắng nghe sự kiện)** là đoạn mã cho phép chương trình lắng nghe và phản ứng với các hành động của người dùng, chẳng hạn như nhấn phím trên bàn phím.

Trong turtle module, có một phần dành riêng cho **screen events** (sự kiện màn hình), bao gồm:

- Lắng nghe phím bấm (key presses)
- Lắng nghe chuột click
- Các sự kiện khác

**Phương thức quan trọng:**

- `listen()`: Bắt đầu lắng nghe và chờ đợi sự kiện từ người dùng
- `onkey()`: Gắn kết một hàm với một phím cụ thể


### Thiết Lập Cơ Bản

```python
from turtle import Turtle, Screen

# Tạo đối tượng turtle và screen
tim = Turtle()
screen = Screen()

# Bắt đầu lắng nghe sự kiện
screen.listen()

# Tạo hàm xử lý sự kiện
def move_forwards():
    tim.forward(10)

# Gắn kết hàm với phím Space
screen.onkey(move_forwards, "space")

# Giữ màn hình không tắt
screen.exitonclick()
```


### Truyền Function Làm Argument

**Điểm quan trọng**: Khi truyền một function làm argument (đối số), không thêm dấu ngoặc đơn `()` ở cuối.

```python
# Đúng: chỉ truyền tên hàm
screen.onkey(move_forwards, "space")

# Sai: thêm () sẽ kích hoạt hàm ngay lập tức
screen.onkey(move_forwards(), "space")  # ❌
```

**Lý do**: Dấu ngoặc `()` sẽ kích hoạt hàm ngay tại thời điểm đó. Nhưng chúng ta muốn phương thức `onkey` lắng nghe và chỉ kích hoạt hàm khi phím được nhấn.

### Higher Order Functions

**Higher Order Functions (Hàm bậc cao)** là hàm có khả năng:

- Nhận một hàm khác làm đối số (argument)
- Hoặc trả về một hàm

**Ví dụ minh họa với Calculator:**

```python
# Các hàm toán học cơ bản
def add(n1, n2):
    return n1 + n2

def subtract(n1, n2):
    return n1 - n2

def multiply(n1, n2):
    return n1 * n2

def divide(n1, n2):
    return n1 / n2

# Higher order function - nhận function làm đối số
def calculator(n1, n2, func):
    return func(n1, n2)

# Sử dụng
result = calculator(2, 3, add)
print(result)  # Output: 5

result = calculator(2, 3, multiply)
print(result)  # Output: 6

result = calculator(2, 3, divide)
print(result)  # Output: 0.666...
```


### Hoạt Động Của Calculator Function

Khi gọi `calculator(2, 3, add)`:

1. Hàm `calculator` nhận ba tham số: `n1=2`, `n2=3`, `func=add`
2. Bên trong, `func(n1, n2)` tương đương với `add(2, 3)`
3. Hàm `add` được kích hoạt và trả về kết quả `5`

### Keyword Arguments vs Positional Arguments

**Khuyến nghị**: Khi sử dụng các phương thức không tự viết (như `onkey`), nên dùng **keyword arguments** (đối số có tên) thay vì **positional arguments** (đối số theo vị trí).

```python
# Tốt hơn - dễ hiểu, rõ ràng
screen.onkey(fun=move_forwards, key="space")

# Cũng được - nhưng khó hiểu hơn
screen.onkey(move_forwards, "space")
```

**Lý do**: Keyword arguments giúp code dễ đọc và tránh nhầm lẫn về thứ tự tham số.

### Ứng Dụng Thực Tế

Event listeners và higher order functions thường được sử dụng trong:

- Xây dựng trò chơi tương tác
- Tạo giao diện người dùng
- Xử lý sự kiện trong ứng dụng
- Lập trình Etch-A-Sketch (dự án tiếp theo)


### Ghi Chú Thêm

Python cho phép sử dụng higher order functions một cách linh hoạt, điều này không có ở tất cả các ngôn ngữ lập trình. Đây là tính năng mạnh mẽ giúp code ngắn gọn và linh hoạt hơn.

**Liên kết:** [[Event Listeners]], [[Higher Order Functions]], [[Turtle Graphics]], [[Screen Events]], [[Callback Functions]], [[Keyword Arguments]]

