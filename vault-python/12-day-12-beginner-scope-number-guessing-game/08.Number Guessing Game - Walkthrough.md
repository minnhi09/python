

## Hướng dẫn xây dựng Number Guessing Game - Walkthrough

### Lời khuyên trước khi xem giải pháp

**Quan trọng:** Trước khi xem hướng dẫn này, hãy dành ít nhất **1 giờ** để tự mình hoàn thành dự án. Chỉ khi bạn thực sự gặp khó khăn và cố gắng giải quyết, bạn mới tiến bộ. Xem code mẫu suốt ngày không làm bạn trở thành lập trình viên giỏi hơn.

### Bước 1: Phân tích và chia nhỏ vấn đề

Khi đối mặt với màn hình trắng, điều đầu tiên là **chia nhỏ dự án thành các thành phần riêng biệt**.

**Phân tích gameplay:**

1. In thông báo chào mừng và hướng dẫn
2. Chọn số ngẫu nhiên từ 1-100
3. Người chơi chọn độ khó (easy/hard)
4. Thiết lập số lượt dựa trên độ khó
5. Người chơi đoán số
6. So sánh số đoán với đáp án
7. Đưa ra phản hồi (too high/too low)
8. Giảm số lượt còn lại
9. Lặp lại cho đến khi đoán đúng hoặc hết lượt

**TODO List từ phân tích:**

```python
# Chọn số ngẫu nhiên từ 1-100
# Hàm thiết lập độ khó
# Cho phép người chơi đoán số
# Hàm kiểm tra đáp án người chơi với đáp án thực
# Theo dõi số lượt và giảm 1 nếu đoán sai
# Lặp lại miễn còn lượt và chưa đoán đúng
```


### Bước 2: Bắt đầu với phần đơn giản nhất

**Chọn số ngẫu nhiên:**

```python
from random import randint

answer = randint(1, 100)
print("Welcome to the Number Guessing Game!")
print("I'm thinking of a number between 1 and 100.")
```

**Lưu ý:** `randint()` bao gồm cả hai đầu (1 và 100 đều có thể xuất hiện).

### Bước 3: Nhận input từ người chơi

```python
guess = int(input("Make a guess: "))
```

**Giải thích:** Chuyển đổi input thành `int` vì người dùng nhập vào là chuỗi (string).

### Bước 4: Hàm kiểm tra đáp án

```python
def check_answer(guess, answer):
    """Checks answer against guess, returns the number of turns remaining."""
    if guess > answer:
        print("Too high.")
    elif guess < answer:
        print("Too low.")
    else:
        print(f"You got it! The answer was {answer}.")
```

**Tối ưu:** Có thể dùng `else` thay vì `elif guess == answer` vì không còn trường hợp nào khác.

### Bước 5: Hàm thiết lập độ khó

**Định nghĩa constants:**

```python
EASY_LEVEL_TURNS = 10
HARD_LEVEL_TURNS = 5
```

**Hàm set_difficulty:**

```python
def set_difficulty():
    level = input("Choose a difficulty. Type 'easy' or 'hard': ")
    if level == "easy":
        return EASY_LEVEL_TURNS
    else:
        return HARD_LEVEL_TURNS
```

**Tại sao dùng return thay vì global?**

- Không cần sử dụng từ khóa `global`
- Hàm độc lập, dễ test và tái sử dụng
- Tránh bug do sửa đổi biến toàn cục

**Sử dụng:**

```python
turns = set_difficulty()
print(f"You have {turns} attempts remaining to guess the number.")
```


### Bước 6: Vòng lặp game với while

**Khởi tạo biến guess:**

```python
def game():
    answer = randint(1, 100)
    print("Welcome to the Number Guessing Game!")
    print("I'm thinking of a number between 1 and 100.")
    print(f"Pssst, the correct answer is {answer}")  # Testing code
    
    turns = set_difficulty()
    
    guess = 0
    while guess != answer:
        print(f"You have {turns} attempts remaining to guess the number.")
        guess = int(input("Make a guess: "))
        check_answer(guess, answer)

game()
```

**Giải thích:**

- Khởi tạo `guess = 0` trước vòng lặp để tránh lỗi "undefined"
- Điều kiện `while guess != answer` đảm bảo lặp cho đến khi đoán đúng
- Đặt game trong hàm để tránh biến toàn cục rối


### Bước 7: Theo dõi và giảm số lượt

**Vấn đề:** Làm sao giảm `turns` mỗi lần đoán sai?

**Giải pháp XẤU - Dùng global:**

```python
turns = 0  # Global variable

def check_answer(guess, answer):
    global turns  # ❌ Không nên làm
    if guess > answer:
        print("Too high.")
        turns -= 1
    elif guess < answer:
        print("Too low.")
        turns -= 1
    else:
        print(f"You got it! The answer was {answer}.")
```

**Giải pháp TỐT - Dùng return:**

```python
def check_answer(guess, answer, turns):
    """Checks answer against guess, returns the number of turns remaining."""
    if guess > answer:
        print("Too high.")
        return turns - 1
    elif guess < answer:
        print("Too low.")
        return turns - 1
    else:
        print(f"You got it! The answer was {answer}.")
```

**Sử dụng trong vòng lặp:**

```python
while guess != answer:
    print(f"You have {turns} attempts remaining to guess the number.")
    guess = int(input("Make a guess: "))
    turns = check_answer(guess, answer, turns)  # Cập nhật turns
```

**Lưu ý quan trọng:** Sử dụng **Python Tutor** để hiểu rõ cách biến `turns` được cập nhật qua return value.

### Bước 8: Xử lý khi hết lượt

**Vấn đề:** Game không dừng khi `turns = 0`, tiếp tục cho phép đoán vô tận.

**Giải pháp:**

```python
def check_answer(guess, answer, turns):
    """Checks answer against guess, returns the number of turns remaining."""
    if guess > answer:
        print("Too high.")
        return turns - 1
    elif guess < answer:
        print("Too low.")
        return turns - 1
    else:
        print(f"You got it! The answer was {answer}.")
        return turns  # Không giảm nếu đoán đúng
```

**Kiểm tra trong vòng lặp:**

```python
while guess != answer:
    print(f"You have {turns} attempts remaining to guess the number.")
    guess = int(input("Make a guess: "))
    turns = check_answer(guess, answer, turns)
    
    if turns == 0:
        print("You've run out of guesses, you lose.")
        return  # Thoát khỏi function, kết thúc game
```

**Giải thích:** Từ khóa `return` (không có giá trị) sẽ thoát khỏi hàm ngay lập tức.

### Bước 9: Thêm thông báo "Guess again"

**Tùy chọn thêm:**

```python
def check_answer(guess, answer, turns):
    """Checks answer against guess, returns the number of turns remaining."""
    if guess > answer:
        print("Too high.")
        return turns - 1
    elif guess < answer:
        print("Too low.")
        return turns - 1
    else:
        print(f"You got it! The answer was {answer}.")
        return turns
```

**Trong vòng lặp:**

```python
turns = check_answer(guess, answer, turns)

if turns == 0:
    print("You've run out of guesses, you lose.")
    return
elif guess != answer:
    print("Guess again.")
```

**Logic:** Chỉ in "Guess again" nếu còn lượt VÀ chưa đoán đúng.

### Code hoàn chỉnh

```python
from random import randint

# Global Constants
EASY_LEVEL_TURNS = 10
HARD_LEVEL_TURNS = 5

def check_answer(guess, answer, turns):
    """Checks answer against guess, returns the number of turns remaining."""
    if guess > answer:
        print("Too high.")
        return turns - 1
    elif guess < answer:
        print("Too low.")
        return turns - 1
    else:
        print(f"You got it! The answer was {answer}.")
        return turns

def set_difficulty():
    """Sets the difficulty level and returns the number of turns."""
    level = input("Choose a difficulty. Type 'easy' or 'hard': ")
    if level == "easy":
        return EASY_LEVEL_TURNS
    else:
        return HARD_LEVEL_TURNS

def game():
    """Main game function."""
    print("Welcome to the Number Guessing Game!")
    print("I'm thinking of a number between 1 and 100.")
    
    answer = randint(1, 100)
    print(f"Pssst, the correct answer is {answer}")  # For testing
    
    turns = set_difficulty()
    
    guess = 0
    while guess != answer:
        print(f"You have {turns} attempts remaining to guess the number.")
        guess = int(input("Make a guess: "))
        
        turns = check_answer(guess, answer, turns)
        
        if turns == 0:
            print("You've run out of guesses, you lose.")
            return
        elif guess != answer:
            print("Guess again.")

game()
```


### Thêm ASCII Art

**Tạo file art.py:**

```python
# art.py
logo = """
  ___                     _____ _            _   _                 _               
 / __|_  _ ___ ______    |_   _| |_  ___    | \ | |_  _ _ __  ___| |__  ___ _ _ 
| (_ | || / -_|_-<_-<      | | | ' \/ -_)   |  \| | || | '  \/ -_) '_ \/ -_) '_|
 \___|\_,_\___/__/__/      |_| |_||_\___|   |_|\_|\_,_|_|_|_\___|_.__/\___|_|  
"""
```

**Import và sử dụng:**

```python
from art import logo

def game():
    print(logo)
    print("Welcome to the Number Guessing Game!")
    # ... rest of code
```


### Các bug thường gặp và cách sửa

**Bug 1: Hỏi guess trước khi chọn độ khó**

❌ **Sai:**

```python
guess = int(input("Make a guess: "))
turns = set_difficulty()
```

✅ **Đúng:**

```python
turns = set_difficulty()
guess = int(input("Make a guess: "))
```

**Bug 2: Không in số lượt còn lại sau mỗi lần đoán**

✅ **Giải pháp:** Đặt print statement **trong vòng lặp while**, ở đầu mỗi iteration.

**Bug 3: Game không dừng khi hết lượt**

✅ **Giải pháp:** Thêm kiểm tra `if turns == 0` và dùng `return` để thoát.

**Bug 4: Số lượt bị âm**

✅ **Giải pháp:** Kiểm tra `turns == 0` **sau** khi giảm, trước khi cho đoán tiếp.

### Bài học quan trọng

**Problem Solving Process:**

1. Chơi game để hiểu rõ cách hoạt động
2. Chia nhỏ thành các tasks đơn giản
3. Viết comments/pseudocode trước
4. Giải quyết từng phần một
5. Test thường xuyên
6. Debug và refine

**Best Practices:**

- Dùng **constants** cho giá trị cố định (viết HOA)
- Dùng **return** thay vì modify global variables
- Viết **docstrings** cho functions
- Đặt code trong **functions** để tránh global scope
- **Test** từng phần trước khi tiếp tục
- Loại bỏ testing code (như print answer) khi hoàn thành

**Scope Lessons:**

- Đọc global variables: ✅ OK
- Sửa global variables với `global`: ❌ Tránh
- Return values từ functions: ✅ Best practice
- Constants toàn cục: ✅ Useful và an toàn


### Mở rộng và cải tiến

**Tính năng có thể thêm:**

- Chơi lại mà không restart program
- Theo dõi số lần chơi và tỷ lệ thắng
- Xử lý invalid input (chữ cái thay vì số)
- Thêm màu sắc cho output
- Lưu high scores


### Kết luận

Nếu bạn gặp khó khăn hoàn thành dự án, hãy chú ý cách **chia nhỏ vấn đề lớn thành các chunks nhỏ hơn**. Mỗi phần nhỏ (như chọn số ngẫu nhiên, tạo hàm kiểm tra) đều dễ giải quyết hơn nhiều. Khi xây dựng từng phần, bạn sẽ nhận ra cần thêm gì và tiếp tục bổ sung.

Hy vọng bạn đã hoàn thành phiên bản riêng của mình và thậm chí còn tốt hơn giải pháp này! Nếu bạn tự hào về sản phẩm của mình, hãy chia sẻ để mọi người cùng xem và chơi thử.

**Liên kết:** [[Number Guessing Game]], [[Problem Solving]], [[Functions]], [[Return Values]], [[Global Constants]], [[while loop]], [[Debugging]], [[Code Refactoring]], [[Best Practices]], [[Python Tutor]]

